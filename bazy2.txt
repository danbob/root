--A) (Wyświetla osoby urodzone przez 1987 rokiem oraz nadal zatrudnione)
select imie1, imie2, nazwisko, data_ur, plec
from osoby o, pensje p
where o.id=p.id_osoby
and p.do is not null
and TO_NUMBER(TO_CHAR(data_ur,'yyyy'))<1987
order by plec
 
--B) (Wyświetla ilość zatrudnionych dni osób z wydziału informatyki)
select o.id, o.nazwisko, round(sysdate - z.od) as dni
from osoby o, wydzialy w, zatrudnienia z
where o.id=z.id_osoby
and w.id=z.id_wydzialy
and w.nazwa='informatyki'
and z.do is null
 
--C) (Wyświetla średnią pensję mężczyzn, którzy już nie pracują)
select round(avg(pensja)) as avg_salary
from pensje p, osoby o
where o.id=p.id_osoby
and p.do is not null
and o.plec = 'M'
 
--E (Wyświetla najmłodzszą osobę zatrudnioną na wydziale o id=2)
select o.imie1, o.imie2, o.nazwisko, o.data_ur, o.plec
from osoby o, zatrudnienia z
where
(select max(o.data_ur) from
osoby o, zatrudnienia z
where o.id=z.id_osoby
and id_wydzialy=2)=data_ur
and z.id_osoby=o.id
and id_wydzialy=2
 
--F (Wyświetla osoby zatrudnione)
select o.imie1, o.imie2, o.nazwisko, o.data_ur, o.plec
from osoby o, zatrudnienia z
where o.id=z.id_osoby
and z.do is null
 
--G (Wyświetla osoby o trzech najkrótszych nazwiskach)
select * from
osoby o, (select id
from osoby
order by length(nazwisko)) l
where o.id=l.id
and rownum<=3
 
--H (Wyświetla najstarsze zatrudnione kobiety)
select * from osoby where data_ur in (
select min(data_ur) from
(select *
from osoby o, zatrudnienia z
where z.id_osoby=o.id
and plec = 'K')
group by id_wydzialy)

--J (Wyświetla najdłuższe kiedyś trwające zatrudnienie)
select round(((b.max-a.min)/365)) zaokrogona_roznica_lat, (b.max-a.min) roznica_dni from
(select * from
(select round(do-od) min
from zatrudnienia
where do is not null
order by round(do-od))
where rownum=1) a, (select * from
(select round(do-od) max
from zatrudnienia
where do is not null
order by round(do-od) desc)
where rownum=1) b
 
--K (Wyświetla szefów wydziałów)
select o.imie1, o.imie2, o.nazwisko, o.data_ur
from osoby o, zatrudnienia z
where o.id=z.id_osoby
and to_char(z.od,'MM-DD')>(select to_char(data_ur,'MM-DD') from
(select data_ur from
osoby o, wydzialy w
where w.szef=o.id
order by data_ur)
where rownum = 1)
 
--L (Najdłużej zatrudniony pracownik - ile jest to miesięcy)
select miesiac from (
select to_char(do,'MM') as miesiac, count(to_char(do,'MM')) as a
from zatrudnienia
where do is not null
group by to_char(do,'MM')
order by a desc)
where rownum = 1
 
--N (?)
select nazwa as DUZA_LITERA from
(select id, substr(nazwa,2,1) from wydzialy
where substr(nazwa,2,1)='i') i, wydzialy w
where i.id=w.id